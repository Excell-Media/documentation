<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>IAM - Excell Media Pvt. Ltd.</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="generator" content="mkdocs-1.6.1, mkdocs-gitbook-1.0.7">

<link rel="shortcut icon" href="../../../images/favicon.ico" type="image/x-icon">
<meta name="HandheldFriendly" content="true"/>
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta rel="next" href="" />
<link href="../../../css/style.min.css" rel="stylesheet">
<link href="../../../assets/custom.css" rel="stylesheet"> 
</head>

<body>
<div class="book">
<div class="book-summary">

<nav role="navigation">
<ul class="summary">
<li>
<a href="../../.." target="_blank" class="custom-link">Excell Media Pvt. Ltd.</a>
</li>
<li class="divider"></li>
<li class="chapter" data-path="">
<a href="../../..">Home</a>
<li class="header">Design</li>

<li>
<a href="#">Infrastructure</a>
<ul>

<li>
<a href="../../infra/" class="">Overview</a>
</li>

<li>
<a href="../../infra/kubernetes/" class="">Kubernetes</a>
</li>

<li>
<a href="../../infra/monolithic/" class="">Monolithic</a>
</li>
</ul>
</li>

<li>
<a href="#">Application</a>
<ul>

<li>
<a href="../" class="">Overview</a>
</li>

<li>
<a href="./" class="active">IAM</a>
</li>

<li>
<a href="#">Microservices</a>
<ul>

<li>
<a href="../ms/" class="">Overview</a>
</li>

<li>
<a href="../ms/keycloak/" class="">Access Management</a>
</li>

<li>
<a href="../ms/iam-admin-api/" class="">User Admin API</a>
</li>

<li>
<a href="../ms/core-api/" class="">Core API</a>
</li>

<li>
<a href="../ms/notify/" class="">Notification API</a>
</li>

<li>
<a href="../ms/storage/" class="">Storage API</a>
</li>
</ul>
</li>
</ul>
</li>

<li class="divider"></li>



<li><a href="http://www.mkdocs.org">
Published with MkDocs
</a></li>

<li><a href="https://github.com/GitbookIO/theme-default">
Theme by GitBook
</a></li>
</ul>

</nav>

</div> <!-- end of book-summary -->

<div class="book-body">
<div class="body-inner">
<div class="book-header" role="navigation">

<!-- Title -->
<h1>
<i class="fa fa-circle-o-notch fa-spin"></i>
<a href="." ></a>
</h1>

</div> <!-- end of book-header -->

<div class="page-wrapper" tabindex="-1" role="main">
<div class="page-inner">

<section class="normal markdown-section">



<h1 id="keycloak">Keycloak</h1>
<h2 id="background">Background</h2>
<p>Keycloak is an open-source identity and access management (IAM) solution that provides authentication and authorization services for applications. Developed by Red Hat, Keycloak simplifies user authentication and security, offering features like Single Sign-On (SSO) and role-based access control (RBAC).</p>
<p>Organizations can configure Keycloak to provide secure authentication without building their own authentication mechanisms.</p>
<p>Keycloak’s notable features applicable for Employee App:</p>
<ol>
<li>Single Sign-On (SSO): Allows users to log in once and access multiple applications without re-authenticating.</li>
<li>Multi-Factor Authentication (MFA): Enhances security by requiring additional authentication steps.</li>
<li>Fine-Grained Access Control: Uses role-based access control (RBAC) and attribute-based access control (ABAC) to enforce security policies.</li>
<li>Extensibility: Offers the ability to customize authentication flows, login screens, and user session handling.</li>
</ol>
<p>Keycloak operates using a realm-based structure, where each realm represents an isolated security domain. Users, roles, and clients (applications) exist within realms, enabling granular control over authentication and authorization policies.</p>
<p>The next section will explore how Keycloak is implemented within Excell to manage authentication and authorization effectively.</p>
<h2 id="keycloak-implementation-for-excell">Keycloak Implementation for Excell</h2>
<h3 id="scopes-and-authorization-strategy">Scopes and Authorization Strategy</h3>
<p>In Excell's implementation of IAM, access control is managed through scopes, which define the features available to a user. These scopes are included as part of the authentication token issued by Keycloak. However, data-level authorizations—such as determining which users fall under a specific hierarchy—are handled separately within the database. This ensures that IAM remains focused on authentication and high-level authorization, while finer data access controls are managed dynamically by the application.</p>
<p>For instance, scopes like <code>view.all</code> allow a user to see reports for users under them, but IAM itself does not determine who these users are. Instead, the system retrieves this hierarchy from the database based on business logic. This separation ensures flexibility and efficiency in access control. A more detailed discussion on data-level authorization is discussed here.</p>
<h3 id="scope-based-implementation">Scope-Based Implementation</h3>
<p>Each functional area in Excell is governed by a predefined set of scopes that dictate user permissions. These scopes are attached to user roles within Keycloak and included in the access token issued upon authentication. Below are the key scopes defined for different modules:</p>
<h4 id="attendance-management">Attendance Management</h4>
<ul>
<li><code>mark.self</code> → Allows the user to mark their own attendance.</li>
<li><code>view.self</code> → Allows the user to view their own attendance records.</li>
<li><code>view.all</code> → Allows the user to view the attendance report of users under them.</li>
</ul>
<h4 id="customer-operations">Customer Operations</h4>
<ul>
<li><code>caf.create</code> → Grants permission to create a new customer CAF (Customer Application Form).</li>
<li><code>caf.view.self</code> → Allows the user to view CAF records associated with them.</li>
<li><code>caf.view.all</code> → Allows the user to view all CAF records of users under them.</li>
</ul>
<h4 id="support-ticketing">Support Ticketing</h4>
<ul>
<li><code>ticket.create</code> → Allows the user to create a new support ticket.</li>
<li><code>ticket.close</code> → Grants permission to close tickets assigned to the user.</li>
<li><code>ticket.view</code> → Allows the user to view their own tickets.</li>
<li><code>ticket.view.all</code> → Allows the user to view tickets created by users under them.</li>
</ul>
<h4 id="user-profile-management">User Profile Management</h4>
<ul>
<li><code>profile.view.self</code> → Allows the user to view their own profile details.</li>
<li><code>profile.modify.self</code> → Grants permission to modify their own profile.</li>
</ul>
<h3 id="implementation-example">Implementation Example</h3>
<p>The implementation follows a role-based approach where roles are assigned to users, and these roles contain specific scopes. When a user logs in, Keycloak issues an access token containing the scopes granted to that user. The application then extracts these scopes and enforces access control accordingly.</p>
<p>For example, when a manager accesses the attendance report, the system:</p>
<ol>
<li>Extracts the user's scopes from the token.</li>
<li>Checks if <code>view.all</code> is present.</li>
<li>If <code>view.all</code> is available, fetches the list of users under the manager from the database.</li>
<li>Displays attendance data only for those users.</li>
</ol>
<p>This ensures that while IAM defines who has the permission to view certain data, the actual data retrieval logic remains separate and dynamic.</p>
<p>We will expand further in the next section to discuss role-based assignments, token validation, and a real-world request-response cycle using Keycloak.</p>


</section>

</div> <!-- end of page-inner -->
</div> <!-- end of page-wrapper -->

</div> <!-- end of body-inner -->

</div> <!-- end of book-body -->
<script src="../../../js/main.js"></script>
<script src="../../../js/gitbook.min.js"></script>
<script src="../../../js/theme.min.js"></script>
</body>
</html>