{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Excell Employee","text":""},{"location":"design/application/","title":"Overview","text":""},{"location":"design/application/#identity-and-access-management-iam","title":"Identity and Access Management (IAM)","text":"<p>IAM is a framework of policies and technologies ensuring that the right individuals in an enterprise have appropriate access to technology resources. It involves authentication, authorization, and user lifecycle management, ensuring that only authorized users can access specific applications and data.</p> <p>IAM helps organizations control user identities and their permissions in a secure and efficient manner. It includes authentication mechanisms such as passwords, multi-factor authentication (MFA), and biometrics to verify users before granting them access. Authorization defines what actions a user can perform, such as read, write, or admin privileges on a resource. Together, these processes mitigate security risks, ensuring that only legitimate users can access sensitive resources.</p> <p>Key components of IAM include:</p> <ol> <li>User Management: Creating, modifying, and deleting user accounts, including roles and permissions.</li> <li>Authentication: Methods like single sign-on (SSO), MFA, and password policies for secure user access.</li> <li>Authorization: Defining roles and access levels to restrict user actions within systems.</li> <li>Identity Federation: Allowing users to log in using credentials from another trusted system, such as social logins or enterprise identity providers.</li> <li>Access Governance: Monitoring and auditing access to ensure compliance with security policies.</li> </ol> <p>A well-implemented IAM strategy enhances security, improves operational efficiency, and ensures compliance with regulatory requirements. It minimizes the risk of unauthorized access, insider threats, and data breaches. Modern IAM solutions are essential for cloud-based environments where organizations need to manage access across various applications and devices securely.</p> <p>In Excell Employee App KeyCloak is proposed for implementation.</p>"},{"location":"design/application/#microservices-architecture","title":"Microservices Architecture","text":""},{"location":"design/application/#short-overview","title":"Short Overview","text":"<p>Microservices architecture is a modern software design approach that structures an application as a collection of small, independent services that communicate with each other through well-defined APIs. Unlike traditional monolithic architectures, where all components are tightly coupled and deployed as a single unit, microservices are loosely coupled and can be developed, deployed, and scaled independently.</p> <p>Each microservice is designed to handle a specific business capability, such as user authentication, ticket processing, or notification handling. These services interact over lightweight communication protocols like REST.</p> <p>Microservices promote agility, scalability, and resilience, making them a preferred choice for cloud-native applications, DevOps workflows, and enterprise-level solutions.</p>"},{"location":"design/application/#advantages","title":"Advantages","text":"Feature Description Scalability Microservices can be scaled independently based on demand, allowing critical services like payment processing to receive more resources without affecting the rest of the system. Fault Isolation &amp; Resilience Failures in one microservice do not impact the entire system, ensuring better fault tolerance and graceful degradation through independent service operations. Faster Development &amp; Deployment Parallel development of microservices enables faster release cycles, while CI/CD pipelines streamline deployment without requiring full system redeployments. Technology Flexibility Different microservices can use varied programming languages, databases, and frameworks, allowing teams to choose the most suitable technology for each service. Improved Maintainability &amp; Modularity With each microservice handling a specific function, the codebase remains smaller and more manageable, making debugging and updates simpler. Enhanced Security &amp; Compliance Sensitive data can be isolated within specific services, reducing system-wide security risks, while compliance requirements can be enforced at a granular level. Better Resource Utilization Deployment in containers (Docker, Kubernetes) ensures optimal resource allocation, with targeted load balancing preventing unnecessary overhead. <p>The microservices in Excell Employee ecosystem are discussed here</p>"},{"location":"design/application/iam/","title":"Keycloak","text":""},{"location":"design/application/iam/#background","title":"Background","text":"<p>Keycloak is an open-source identity and access management (IAM) solution that provides authentication and authorization services for applications. Developed by Red Hat, Keycloak simplifies user authentication and security, offering features like Single Sign-On (SSO) and role-based access control (RBAC).</p> <p>Organizations can configure Keycloak to provide secure authentication without building their own authentication mechanisms.</p> <p>Keycloak\u2019s notable features applicable for Employee App:</p> <ol> <li>Single Sign-On (SSO): Allows users to log in once and access multiple applications without re-authenticating.</li> <li>Multi-Factor Authentication (MFA): Enhances security by requiring additional authentication steps.</li> <li>Fine-Grained Access Control: Uses role-based access control (RBAC) and attribute-based access control (ABAC) to enforce security policies.</li> <li>Extensibility: Offers the ability to customize authentication flows, login screens, and user session handling.</li> </ol> <p>Keycloak operates using a realm-based structure, where each realm represents an isolated security domain. Users, roles, and clients (applications) exist within realms, enabling granular control over authentication and authorization policies.</p> <p>The next section will explore how Keycloak is implemented within Excell to manage authentication and authorization effectively.</p>"},{"location":"design/application/iam/#keycloak-implementation-for-excell","title":"Keycloak Implementation for Excell","text":""},{"location":"design/application/iam/#scopes-and-authorization-strategy","title":"Scopes and Authorization Strategy","text":"<p>In Excell's implementation of IAM, access control is managed through scopes, which define the features available to a user. These scopes are included as part of the authentication token issued by Keycloak. However, data-level authorizations\u2014such as determining which users fall under a specific hierarchy\u2014are handled separately within the database. This ensures that IAM remains focused on authentication and high-level authorization, while finer data access controls are managed dynamically by the application.</p> <p>For instance, scopes like <code>view.all</code> allow a user to see reports for users under them, but IAM itself does not determine who these users are. Instead, the system retrieves this hierarchy from the database based on business logic. This separation ensures flexibility and efficiency in access control. A more detailed discussion on data-level authorization is discussed here.</p>"},{"location":"design/application/iam/#scope-based-implementation","title":"Scope-Based Implementation","text":"<p>Each functional area in Excell is governed by a predefined set of scopes that dictate user permissions. These scopes are attached to user roles within Keycloak and included in the access token issued upon authentication. Below are the key scopes defined for different modules:</p>"},{"location":"design/application/iam/#attendance-management","title":"Attendance Management","text":"<ul> <li><code>mark.self</code> \u2192 Allows the user to mark their own attendance.</li> <li><code>view.self</code> \u2192 Allows the user to view their own attendance records.</li> <li><code>view.all</code> \u2192 Allows the user to view the attendance report of users under them.</li> </ul>"},{"location":"design/application/iam/#customer-operations","title":"Customer Operations","text":"<ul> <li><code>caf.create</code> \u2192 Grants permission to create a new customer CAF (Customer Application Form).</li> <li><code>caf.view.self</code> \u2192 Allows the user to view CAF records associated with them.</li> <li><code>caf.view.all</code> \u2192 Allows the user to view all CAF records of users under them.</li> </ul>"},{"location":"design/application/iam/#support-ticketing","title":"Support Ticketing","text":"<ul> <li><code>ticket.create</code> \u2192 Allows the user to create a new support ticket.</li> <li><code>ticket.close</code> \u2192 Grants permission to close tickets assigned to the user.</li> <li><code>ticket.view</code> \u2192 Allows the user to view their own tickets.</li> <li><code>ticket.view.all</code> \u2192 Allows the user to view tickets created by users under them.</li> </ul>"},{"location":"design/application/iam/#user-profile-management","title":"User Profile Management","text":"<ul> <li><code>profile.view.self</code> \u2192 Allows the user to view their own profile details.</li> <li><code>profile.modify.self</code> \u2192 Grants permission to modify their own profile.</li> </ul>"},{"location":"design/application/iam/#implementation-example","title":"Implementation Example","text":"<p>The implementation follows a role-based approach where roles are assigned to users, and these roles contain specific scopes. When a user logs in, Keycloak issues an access token containing the scopes granted to that user. The application then extracts these scopes and enforces access control accordingly.</p> <p>For example, when a manager accesses the attendance report, the system:</p> <ol> <li>Extracts the user's scopes from the token.</li> <li>Checks if <code>view.all</code> is present.</li> <li>If <code>view.all</code> is available, fetches the list of users under the manager from the database.</li> <li>Displays attendance data only for those users.</li> </ol> <p>This ensures that while IAM defines who has the permission to view certain data, the actual data retrieval logic remains separate and dynamic.</p> <p>We will expand further in the next section to discuss role-based assignments, token validation, and a real-world request-response cycle using Keycloak.</p>"},{"location":"design/application/ms/","title":"Microservices","text":""},{"location":"design/application/ms/#microservices-in-excells-architecture","title":"Microservices in Excell's Architecture","text":"<p>To ensure scalability, modularity, and flexibility in its system design. Functionalities are divided into independent services, each responsible for a specific domain. This approach allows to develop, deploy, and scale services independently, improving performance and maintainability.</p> <p>At the core of microservices ecosystem is IAM, which governs authentication and authorization using Keycloak. Additional services handle business logic, notifications, storage, external integrations, and system observability.</p> <p>Each microservice operates as a self-contained unit, communicating with others through lightweight APIs. This architecture not only enhances reliability but also enables seamless horizontal scaling, ensuring optimal performance even under high workloads.</p> <p>The following table provides an overview of the key microservices in Excell\u2019s architecture:</p> Microservice Description IAM Service Keycloak with PostgreSQL for identity and access management. IAM Admin API Service Exposes admin APIs for creating, deleting users, managing groups, and assigning roles. Core API Service Backend API for the user interface and mobile app. Notification Service Aggregator for sending SMS, mobile notifications, emails, and alerts. Storage Service Exposes APIs for adding, viewing, and managing files. External API Service Interface for external APIs like Aadhaar authentication. Observability Service Uses Fluent Bit, Prometheus, and Grafana for centralized logging and server performance monitoring."},{"location":"design/application/ms/core-api/","title":"Core API Service","text":"<p>The Core API Service is the backbone of the Excell Employee App, responsible for handling all core business processes. It acts as the central interface for different functionalities, enabling seamless interactions between the user interface, microservices, and external integrations. This service ensures that business logic is executed efficiently while maintaining modularity and scalability.</p>"},{"location":"design/application/ms/core-api/#key-responsibilities","title":"Key Responsibilities","text":"<ul> <li>Managing core business processes such as inventory, support tickets, and customer onboarding</li> <li>Interacting with other microservices for functionalities like notifications, authentication, and storage</li> <li>Integrating with third-party APIs for external verifications and data exchange</li> <li>Providing a unified API gateway for the Employee App, ensuring a consistent and secure interface for client applications</li> </ul>"},{"location":"design/application/ms/core-api/#major-features","title":"Major Features","text":""},{"location":"design/application/ms/core-api/#inventory-management","title":"Inventory Management","text":"<ul> <li>Maintain stock levels and track real-time inventory usage</li> <li>Automated stock updates based on transactions</li> <li>Role-based access control for inventory operations</li> </ul>"},{"location":"design/application/ms/core-api/#support-ticket-management","title":"Support Ticket Management","text":"<ul> <li>Allow employees to create and track support tickets</li> <li>Assign, update, and resolve tickets efficiently</li> <li>Integrate with the notification service for real-time ticket updates</li> </ul>"},{"location":"design/application/ms/core-api/#customer-lead-management","title":"Customer &amp; Lead Management","text":"<ul> <li>Capture and manage customer leads through a streamlined process</li> <li>Automate customer onboarding via Customer Application Form (CAF)</li> <li>Maintain customer history and lifecycle data</li> </ul>"},{"location":"design/application/ms/core-api/#microservices-and-third-party-api-interactions","title":"Microservices and Third-Party API Interactions","text":"<ul> <li>Send notifications (SMS, emails, in-app alerts) via the Notification Service</li> <li>Authenticate users and manage roles through the IAM service</li> <li>Connect with third-party APIs for external validation (e.g., Aadhaar authentication for KYC)</li> </ul>"},{"location":"design/application/ms/core-api/#technology-stack","title":"Technology Stack","text":"<ul> <li>Node.js for handling API logic and microservices architecture</li> <li>TypeScript for type safety and better maintainability</li> <li>Multiple databases based on specific service requirements, ensuring optimized storage solutions</li> </ul> <p>The Core API Service plays a critical role in Excell\u2019s microservices ecosystem, providing a scalable, modular, and efficient way to manage key business operations.</p>"},{"location":"design/application/ms/iam-admin-api/","title":"User Admin API","text":""},{"location":"design/application/ms/iam-admin-api/#iam-admin-api-for-keycloak","title":"IAM Admin API for Keycloak","text":"<p>The IAM Admin API is responsible for managing users, roles, and role assignments within Keycloak. It provides endpoints to create, update, and delete users, as well as assign roles at both an individual and bulk level. This API serves as the foundation for the administrative interface, which will allow system administrators to manage identity and access-related tasks efficiently.</p> <p>The IAM Admin API will be consumed by an Admin UI, which will provide a user-friendly interface for managing authentication-related operations. The UI will interact with these APIs to perform bulk user creation, role assignments, and general user management.</p>"},{"location":"design/application/ms/iam-admin-api/#key-features-of-iam-admin-api","title":"Key Features of IAM Admin API","text":"<ul> <li>User management: Create, update, delete users within Keycloak</li> <li>Role management: Create and assign roles to users and groups</li> <li>Bulk user operations: APIs to support bulk user creation and role assignments</li> <li>Integration with the Admin UI: A web-based interface that interacts with these APIs</li> </ul>"},{"location":"design/application/ms/iam-admin-api/#advanced-configurations-via-keycloak-admin-panel","title":"Advanced Configurations via Keycloak Admin Panel","text":"<p>While the IAM Admin API handles user and role management, advanced configurations of Keycloak are managed through the Keycloak Admin Panel, which comes as part of Keycloak\u2019s default installation. These configurations include:</p> <ul> <li>Setting up identity providers such as LDAP, Active Directory, or social logins</li> <li>Configuring authentication flows, including multi-factor authentication (MFA) and conditional authentication</li> <li>Managing realm settings like session timeouts, token expiration policies, and security settings</li> <li>Defining fine-grained authorization policies using Keycloak\u2019s built-in policy engine</li> <li>Enabling and configuring Single Sign-On (SSO) across multiple applications</li> </ul>"},{"location":"design/application/ms/iam-admin-api/#technology-stack","title":"Technology Stack","text":"<ul> <li>Node.js for server-side execution</li> <li>TypeScript for type safety and maintainability</li> <li>MongoDB for storing user metadata and additional information not managed directly by Keycloak</li> </ul> <p>This setup ensures that the IAM Admin API is scalable, secure, and extensible, providing a seamless interface for managing authentication and authorization in Excell\u2019s ecosystem.</p>"},{"location":"design/application/ms/keycloak/","title":"Access Management Microservice","text":""},{"location":"design/application/ms/keycloak/#authentication-flow-for-employee-app-using-keycloak","title":"Authentication Flow for Employee App Using Keycloak","text":"<p>To enable seamless authentication, Excell\u2019s Employee App follows the OAuth 2.0 Authorization Code Flow using Keycloak as the identity provider (IdP). This ensures that users authenticate securely without exposing their credentials to the application. The process follows Single Sign-On (SSO) principles, meaning once authenticated, the user can access multiple services without logging in again.</p> <p>The flow involves redirecting unauthenticated users to Keycloak, validating their credentials, and exchanging an authorization code for tokens, which are used to maintain authenticated sessions. Below is the step-by-step process:</p> <p> </p>"},{"location":"design/application/ms/keycloak/#authentication-steps","title":"Authentication Steps","text":"Step Activity Description 1 User Accesses the Employee App The user attempts to access the Employee App (<code>employee.app.com</code>) but is not logged in. 2 Employee App Redirects to Keycloak The Employee App detects the user is unauthenticated and redirects them to Keycloak for login. The request includes parameters such as <code>client_id</code>, <code>redirect_uri</code>, and <code>response_type=code</code>. 3 User Submits Credentials &amp; Keycloak Validates The user enters their credentials (username &amp; password) on the Keycloak login page. Keycloak verifies the credentials and checks for any additional authentication requirements (such as MFA, if enabled). 4 Keycloak Redirects Back to the Employee App with Authorization Code Once authentication is successful, Keycloak redirects the user to the Employee App with an authorization code in the URL (<code>?code=xyz123</code>). This code is temporary and must be exchanged for tokens. 5 Employee App Exchanges Code for Tokens &amp; Starts Session The Employee App makes a server-to-server request to Keycloak\u2019s token endpoint, sending the authorization code along with client credentials. Keycloak responds with an Access Token, ID Token, and Refresh Token. The Employee App verifies the received tokens and establishes an authenticated session for the user. <p>Once logged in, the user remains authenticated until the session expires or they log out. The tokens can be used for subsequent API calls to verify user identity and permissions.</p> <p>This process ensures that authentication remains secure and centralized, leveraging Keycloak\u2019s identity and access management capabilities for seamless SSO across Excell\u2019s ecosystem.</p>"},{"location":"design/application/ms/keycloak/#authentication-flow-for-backend-apis-using-keycloak","title":"Authentication Flow for Backend APIs Using Keycloak","text":"<p>To ensure secure access to backend services, the Employee App uses an Access Token issued by Keycloak. This token is included in the HTTP headers of API requests and is verified by the backend before granting access to protected resources. The authentication process ensures that only authorized users can interact with backend services while maintaining security and compliance.</p> <p>The following diagram illustrates the interaction between the Employee App, Backend API, and Keycloak during token validation.</p> <p> </p>"},{"location":"design/application/ms/keycloak/#authentication-steps_1","title":"Authentication Steps","text":"Step Activity Description 1 User Accesses the Employee App The user is already authenticated and interacts with the Employee App. 2 App Sends Access Token in HTTP Header The Employee App includes the Access Token in the HTTP Authorization header when making a request to the backend API. 3 Backend Looks Up Realm Public Key The backend checks its cache for the Realm Public Key using the <code>kid</code> (Key ID) in the JWT header to verify the token's signature. 3a Fetch Public Key if Not Cached If the Realm Public Key is not found in the cache, the backend requests it from Keycloak using the <code>kid</code>. 3b Keycloak Returns the Realm Public Key Keycloak provides the Realm Public Key, allowing the backend to verify the token\u2019s signature. 4 Backend Verifies the Token The backend validates the Access Token signature using the Realm Public Key to ensure it is authentic and untampered. 5 Backend Grants Access &amp; Returns Data Once the token is verified, the backend grants access and returns the requested user data. <p>This authentication flow ensures that:</p> <ul> <li>Only authorized users with a valid Access Token can interact with backend services.</li> <li>Tokens are securely validated before granting access.</li> <li>The backend does not store passwords, relying entirely on Keycloak for authentication.</li> </ul> <p>This mechanism provides a secure, scalable, and centralized authentication model, leveraging Keycloak's capabilities for identity and access management.</p>"},{"location":"design/application/ms/keycloak/#technology-stack","title":"Technology Stack","text":"<ul> <li>Latest stable version of keycloak</li> <li>PostgreSQL for storing keycloak meta data for persistance</li> </ul>"},{"location":"design/application/ms/notify/","title":"Notification Service","text":"<p>The Notification Service is responsible for handling all communication needs across various applications and services that require sending notifications via SMS, email, and mobile push notifications. It ensures reliable delivery of messages by leveraging a queue-based architecture for scalability and fault tolerance.</p>"},{"location":"design/application/ms/notify/#key-responsibilities","title":"Key Responsibilities","text":"<ul> <li>Receiving notification requests from multiple services and applications</li> <li>Queuing requests in Redis Streams for asynchronous processing</li> <li>Processing queued requests and sending notifications via the appropriate channel</li> <li>Ensuring messages contain the correct contact details and content format</li> </ul>"},{"location":"design/application/ms/notify/#notification-workflow","title":"Notification Workflow","text":"Step Activity Description 1 Receiving Notification Requests Various services submit notification requests, specifying the notification type (SMS, email, mobile push). Each request includes the recipient\u2019s contact details and message content. 2 Queuing Requests in Redis Streams All requests are pushed into Redis Streams to ensure sequential processing and avoid loss of messages. This allows for high-throughput and scalable message handling. 3 Processing and Sending Notifications A dedicated service retrieves requests from the queue and processes them based on notification type. 3a SMS Processing Extracts the recipient\u2019s phone number and message content, then forwards the request to an SMS gateway. 3b Email Processing Uses the email address and pre-formatted HTML content to send emails via an email provider. 3c Mobile Notification Processing Sends push notifications to the specified device using the unique device ID, including the header image and content."},{"location":"design/application/ms/notify/#request-structure","title":"Request Structure","text":""},{"location":"design/application/ms/notify/#contact-details","title":"Contact Details","text":"Notification Type Required Contact Information SMS Mobile number Email Email address Mobile Notification Unique device ID"},{"location":"design/application/ms/notify/#message-content","title":"Message Content","text":"Notification Type Required Content SMS Text message content Email HTML content including subject and body Mobile Notification Header image and notification content"},{"location":"design/application/ms/notify/#technology-stack","title":"Technology Stack","text":"<ul> <li>Node.js for handling API logic and message processing</li> <li>TypeScript for type safety and structured development</li> <li>Redis for queueing notification requests and ensuring message durability</li> <li>MongoDB for notification information persistance and reporting</li> </ul>"}]}